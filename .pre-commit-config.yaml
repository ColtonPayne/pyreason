exclude: 'pyreason/\.cache_status\.yaml'
repos:
  - repo: local
    hooks:
      # --- COMMIT STAGE: Fast unit tests only ---
      - id: sync-interpretation-parallel
        name: Sync interpretation_parallel.py from interpretation.py
        entry: .venv/bin/python sync_interpretation_parallel.py
        language: system
        pass_filenames: false
        files: 'pyreason/scripts/interpretation/interpretation\.py'
        stages: [pre-commit]

      - id: pytest-unit-no-jit
        name: Run JIT-disabled unit tests
        entry: .venv/bin/python -m pytest tests/unit/disable_jit -m "not slow" --tb=short -q
        language: system
        pass_filenames: false
        stages: [pre-commit]

      - id: pytest-unit-jit
        name: Run JIT-enabled unit tests
        entry: .venv/bin/python -m pytest tests/unit/dont_disable_jit -m "not slow" --tb=short -q
        language: system
        pass_filenames: false
        stages: [pre-commit]

      # --- PUSH STAGE: Complete test suite ---

      - id: pytest-unit-api
        name: Run pyreason api unit tests
        entry: .venv/bin/python -m pytest tests/unit/api_tests --tb=short -q
        language: system
        pass_filenames: false
        stages: [pre-push]

      - id: pytest-file-consistency
        name: Verify interpretation files are in sync
        entry: .venv/bin/python -m pytest tests/unit/api_tests/test_pyreason_file_consistency.py -v
        language: system
        pass_filenames: false
        stages: [pre-push]

      - id: pytest-functional-complete
        name: Run functional test suite
        entry: .venv/bin/python -m pytest tests/functional/ --tb=short
        language: system
        pass_filenames: false
        stages: [pre-push]
